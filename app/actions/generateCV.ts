'use server';

import { google } from '@ai-sdk/google';
import { generateText } from 'ai';
import { fetchLinkedinProfile } from '../services/linkedinService';

export async function generateCV(linkedinUrl: string, content?: string) {
  try {
    let profileContent = content;

    if (linkedinUrl && !content) {
      const match = linkedinUrl.match(/linkedin\.com\/in\/([^/]+)/);
      const profileName = match ? match[1] : linkedinUrl;
      const data = await fetchLinkedinProfile(profileName);
      profileContent = JSON.stringify(data, null, 2);
    }

    const prompt = `
    Analiza el siguiente perfil de LinkedIn y genera un CV profesional:

    {'data': {'url': 'https://hu.linkedin.com/in/miguel-angel-garzon-sanabria-742b16257', 'profile': 'miguel-angel-garzon-sanabria-742b16257', 'crawled_at': '25/09/2025 02:59:23', 'name': 'Miguel Angel Garzon Sanabria', 'description': 'Desarrollador Backend con sólida experiencia en la creación de APIs REST y GraphQL utilizando Spring Boot, aplicando arquitecturas hexagonales, consultas JPA y principios de Clean Code para garantizar soluciones limpias, escalables y mantenibles. Complemento mi experiencia en Java con el desarrollo de soluciones en Python, enfocadas en la aplicación de modelos de Machine Learning entrenados y expuestos a través de APIs REST. He liderado la creación de soluciones innovadoras que integran modelos de lenguaje de gran escala (LLM), técnicas como Retrieval-Augmented Generation (RAG), embeddings, y bases de datos vectoriales, permitiendo la generación de respuestas altamente contextualizadas y precisas desde nuestras APIs. Desarrollo APIs que no solo consumen modelos de ML, sino que también los entrenan y adaptan dinámicamente a los requerimientos cambiantes del negocio. Poseo experiencia en la integración de servicios en la nube con AWS, trabajando con herramientas como SQS, API Gateway, SES, DynamoDB, Cognito y Secrets Manager. Optimizo el rendimiento de aplicaciones empresariales y aseguro la calidad del software mediante pruebas unitarias y end-to-end con JUnit, Mockito, SonarQube y JaCoCo. También tengo conocimientos en contenedorización con Docker y manejo de control de versiones con Git y GitHub. Mi enfoque está centrado en construir soluciones eficientes, seguras y orientadas a resultados, con un compromiso continuo hacia la mejora, la automatización inteligente y la adopción de nuevas tecnologías.', 'location': 'Bogotá, Capital District, Colombia', 'followers': '157 followers', 'connections': '156 connections', 'experience': [{'title': 'Machine Learning Engineer', 'company_name': 'Corporación Unificada Nacional de Educación Superior CUN', 'company_link': 'https://co.linkedin.com/school/corporacion-unificada-nacional-de-educacion-superior-cun/', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E0BAQEYbQ8iPVn0vQ/company-logo_100_100/B4EZeN2bwUHwAU-/0/1750431547096/corporacion_unificada_nacional_de_educacion_superior_cun_logo?e=2147483647&v=beta&t=r32ZnkDY1PJDpQhuUaUi3jZQTK456gUKyeCDt8_aHUc', 'date': {'start_date': 'Jul 2025', 'end_date': 'Present', 'duration': {'years': 0, 'months': 3}}, 'location': 'Área metropolitana de Bogotá D.C.', 'description': 'Especialista en ajuste fino (fine-tuning) de modelos de IA, gesti&#xF3;n de arquitecturas de orquestaci&#xF3;n con MCP, desarrollo de APIs escalables, conexi&#xF3;n de servicios inteligentes y automatizaci&#xF3;n de procesos mediante flujos dise&#xF1;ados en n8n. <!---->'}, {'title': 'Machine Learning Engineer', 'company_name': 'Novatec Solutions', 'company_link': 'https://co.linkedin.com/company/novatecsolutions', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E0BAQGxVHn5qF9THA/company-logo_100_100/company-logo_100_100/0/1689088870055/novatecsolutions_logo?e=2147483647&v=beta&t=dVG_sEmDQJuoL52TGDlMBDvaal9zeXy0nsTY-kL1YfM', 'date': {'start_date': 'Apr 2024', 'end_date': 'Jul 2025', 'duration': {'years': 1, 'months': 3}}, 'location': 'Bogotá, Distrito Capital, Colombia', 'description': 'Creaci&#xF3;n de soluciones innovadoras que aprovechan la potencia del Machine Learning y los modelos de lenguaje de gran escala (LLM), mediante API REST. Impulso la creaci&#xF3;n de APIs que no solo consumen modelos de Machine Learning, sino que tambi&#xE9;n entrenan y ajustan estos modelos din&#xE1;micamente para adaptarse a las necesidades cambiantes del negocio. <br> <br> Dise&#xF1;o y desarrollo de arquitecturas que integran t&#xE9;cnicas avanzadas como Retrieval-Augmented Generation (RAG), embeddings, y bases de datos vectoriales para mejorar la precisi&#xF3;n y relevancia de las respuestas generadas por LLMs. Esto permite a nuestras APIs proporcionar informaci&#xF3;n m&#xE1;s contextualizada, relevante y &#xFA;til para las aplicaciones empresariales. <br> <br> Me encargo del entrenamiento, validaci&#xF3;n y mantenimiento de modelos de Machine Learning, asegurando su precisi&#xF3;n, rendimiento y eficacia cuando son expuestos a trav&#xE9;s de APIs REST. Tambi&#xE9;n participo activamente en el despliegue de soluciones en producci&#xF3;n, conectando modelos inteligentes con aplicaciones de negocio reales para ofrecer valor tangible a los clientes.'}, {'title': 'Software Engineer', 'company_name': 'Mom Seguros', 'company_link': 'https://co.linkedin.com/company/mom-seguros', 'image_url': 'https://media.licdn.com/dms/image/v2/C560BAQEK9-Pk7jhaPA/company-logo_100_100/company-logo_100_100/0/1673017203248/mom_seguros_logo?e=2147483647&v=beta&t=SA8T0c2QFcZVlnnc5ItJoZnS-QH4TBavWIirC1Q62xU', 'date': {'start_date': 'Aug 2023', 'end_date': 'Apr 2024', 'duration': {'years': 0, 'months': 9}}, 'location': 'Bogotá, Capital District, Colombia', 'description': 'Como desarrollador backend especializado, lidero la creaci&#xF3;n de endpoints robustos y eficientes. Mi enfoque no solo se limita a la codificaci&#xF3;n, sino que tambi&#xE9;n garantizo la calidad del c&#xF3;digo mediante pruebas unitarias y end-to-end exhaustivas. Adem&#xE1;s, gestiono las integraciones con terceros, asegurando una comunicaci&#xF3;n fluida y fiable entre sistemas. Estas integraciones son sometidas a rigurosas pruebas de integraci&#xF3;n para garantizar su funcionamiento sin contratiempos. <br> <br> Una parte integral de mi trabajo es la implementaci&#xF3;n de contenedores Docker, lo que permite una distribuci&#xF3;n eficiente y escalable de nuestra aplicaci&#xF3;n. Esta arquitectura facilita la portabilidad y la gesti&#xF3;n del entorno de desarrollo y producci&#xF3;n.'}, {'title': 'Universidad de La Amazonia', 'company_name': 'Universidad de La Amazonia', 'company_link': 'https://co.linkedin.com/school/universidad-de-la-amazonia/?trk=public_profile_experience-group-header', 'image_url': None, 'date': {'start_date': None, 'end_date': None, 'duration': {'years': 0, 'months': 0}}, 'location': 'Florencia, Caquetá, Colombia', 'description': None}], 'education': [{'university_name': 'Universidad de La Amazonia', 'university_link': 'https://co.linkedin.com/school/universidad-de-la-amazonia/?trk=public_profile_school_profile-section-card_image-click', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E0BAQHDxKYdj3tNeQ/company-logo_100_100/company-logo_100_100/0/1688049511649/universidad_de_la_amazonia_logo?e=2147483647&v=beta&t=jNv7Y-9H0DhASqV_7SfAWDkqYmjiqG5ggMPTfdU3NqM', 'degree': 'Ingeniero en sistemas', 'major': 'Programación', 'date': {'start_date': '2017', 'end_date': '2023'}}], 'certifications': [{'image_url': '', 'title': 'Desarrollo Backend con Java', 'course_link': 'https://platzi.com/p/mig.garzon/ruta/44-desarrollo-java/diploma/detalle/?trk=public_profile_see-credential', 'issuer': 'Platzi', 'issued_date': 'Jul 2023 Credential ID 9c495658-3f98-43c9-8769-9b3fc1e43fc5', 'credential': '9c495658-3f98-43c9-8769-9b3fc1e43fc5'}, {'image_url': '', 'title': 'Metodologías ágiles', 'course_link': 'https://platzi.com/p/mig.garzon/ruta/8284-metodologias-agiles/diploma/detalle/?trk=public_profile_see-credential', 'issuer': 'Platzi', 'issued_date': 'Jul 2023 Credential ID 823ef1d5-95dd-481b-9221-a82fa054765d', 'credential': '823ef1d5-95dd-481b-9221-a82fa054765d'}, {'image_url': '', 'title': 'Backend con C# y .NET', 'course_link': 'https://platzi.com/p/mig.garzon/ruta/9560-web-net/diploma/detalle/?trk=public_profile_see-credential', 'issuer': 'Platzi', 'issued_date': 'Jun 2023 Credential ID 67ba505c-6ddd-4e0c-8e06-4518c4de47ed', 'credential': '67ba505c-6ddd-4e0c-8e06-4518c4de47ed'}, {'image_url': '', 'title': 'Backend con Python', 'course_link': 'https://platzi.com/p/mig.garzon/learning-path/7050-web-python/diploma/detalle/?trk=public_profile_see-credential', 'issuer': 'Platzi', 'issued_date': 'May 2023 Credential ID ef9d93c7-0b35-4536-8109-1c1fd5f30a8f', 'credential': 'ef9d93c7-0b35-4536-8109-1c1fd5f30a8f'}, {'image_url': '', 'title': 'Curso Profesional de Git y GitHub', 'course_link': 'https://platzi.com/p/mig.garzon/curso/1557-git-github/diploma/detalle/?trk=public_profile_see-credential', 'issuer': 'Platzi', 'issued_date': 'Apr 2023 Credential ID 0d361376-4ed8-4528-89ef-d904e8c9af36', 'credential': '0d361376-4ed8-4528-89ef-d904e8c9af36'}, {'image_url': '', 'title': 'Página web con Flutter', 'course_link': 'https://codigofacilito.com/certificates/129550?trk=public_profile_see-credential', 'issuer': 'Código Facilito', 'issued_date': 'Feb 2024 Expires Feb 2034 Credential ID 129550', 'credential': '129550'}, {'image_url': '', 'title': 'Curso de introducción a Machine Learning', 'course_link': 'https://codigofacilito.com/certificates/101838?trk=public_profile_see-credential', 'issuer': 'Código Facilito', 'issued_date': 'Nov 2023 Expires Nov 2033 Credential ID 101838', 'credential': '101838'}, {'image_url': '', 'title': 'Curso de Machine Learning con ScikitLearn', 'course_link': 'https://codigofacilito.com/certificates/104035?trk=public_profile_see-credential', 'issuer': 'Código Facilito', 'issued_date': 'Nov 2023 Expires Nov 2033 Credential ID 104035', 'credential': '104035'}, {'image_url': '', 'title': 'Curso Profesional de Docker', 'course_link': 'https://codigofacilito.com/certificates/104025?trk=public_profile_see-credential', 'issuer': 'Código Facilito', 'issued_date': 'Nov 2023 Expires Nov 2033 Credential ID 104025', 'credential': '104025'}], 'languages': [], 'volunteerings': [], 'publications': [], 'projects': [{'name': 'Desarrollo de un aplicativo para el control de ventas', 'date': {'start_date': 'Jan 2023', 'end_date': None}, 'description': 'Se ha desarrollado una aplicación que utiliza Python para el backend y Flutter para el frontend. El sistema se encarga del registro de ventas y supervisa la calidad de los productos. La combinación de un backend sólido en Python y un frontend interactivo en Flutter permite una experiencia fluida para los usuarios, al tiempo que garantiza un seguimiento preciso y eficaz de las ventas y la calidad de los productos.'}, {'name': 'Fine Tuning Model Gpt 2', 'date': {'start_date': 'Jan 2025', 'end_date': None}, 'description': 'Este proyecto implementa una arquitectura completa que integra Fine-Tuning de modelos GPT-2 y visión computacional con un flujo automatizado. Se desarrolló un frontend en React encargado de consumir datos desde una API REST, la cual es orquestada mediante N8N, una herramienta de automatización de flujos de trabajo.Dentro del flujo de N8N, se levantaron dos endpoints principales:API con modelo GPT-2 Fine-Tuning: Entrenado específicamente para ajustarse a necesidades personalizadas de generación de texto.API de Visión Computacional: también afinada (fine-tuned) para tareas de análisis y procesamiento de imágenes.El frontend permite a los usuarios interactuar de forma intuitiva con ambos modelos, enviando solicitudes que el flujo de N8N recibe, procesa y reenvía a los modelos especializados, devolviendo la información procesada en tiempo real.'}, {'name': 'Análisis de datos con distribuciones estadísticas', 'date': {'start_date': 'Sep 2023', 'end_date': None}, 'description': 'En el análisis de datos con Python, se aplican distribuciones binomiales a conjuntos de datos recolectados. Estos datos se transforman y organizan de manera sistemática para garantizar la precisión y eficacia en el proceso de análisis. La aplicación de distribuciones binomiales permite modelar fenómenos que implican resultados binarios o de conteo, lo que resulta útil en una amplia gama de campos, como ciencias sociales, biología, y otros campos de investigación y análisis.'}], 'courses': [], 'honors_and_awards': [], 'activities': [{'title': '#TrabajoSíHay Buscamos Ingeniero/a de Soluciones para que haga parte del equipo del Instituto Humboldt. Si te apasiona el desarrollo de software…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E22AQHX5rM0UUfnXQ/feedshare-shrink_1280/B4EZlTPNHGHgAs-/0/1758038119340?e=2147483647&v=beta&t=RIYB3Oa8691heNDFRzzPITPtLcAnMoYKnix6t0U8coA', 'link': 'https://es.linkedin.com/posts/institutohumboldt_trabajos%C3%ADhay-juntosporlabiodiversidad-activity-7373746319074414592-IFbq'}, {'title': 'Today was filled with learning and friendship making with Python enthusiasts of many disciplines. Loved sharing ideas, meeting new friends, and…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E22AQFnd-uo3kCAUg/feedshare-shrink_2048_1536/B4EZfX8yL3HsAo-/0/1751674731127?e=2147483647&v=beta&t=gnmcabLaihSAaYYv6401Z_dkwbxVDlegNgL5dHgqCTk', 'link': 'https://www.linkedin.com/posts/hire-jusegoram_pyconcolombia2025-activity-7347056347030454272-2PV8'}, {'title': 'LENGUAS DE PROGRAMACIÓN MÁS POPULARES ¡De acuerdo con Tiobe Index, Python sigue siendo el lenguaje de programación más popular! Seguir C++, C, Java y…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E22AQHbQeFkPBsvQg/feedshare-shrink_2048_1536/B4EZfmplPQGwAs-/0/1751921350319?e=2147483647&v=beta&t=lK2WduaMLR-N1mJgVDkbTlLs9pNLqHvZJSEH5tckxTI', 'link': 'https://es.linkedin.com/posts/marcoamunozm_lenguas-de-programaci%C3%B3n-m%C3%A1s-populares-de-activity-7348090730784993280-tSqs'}, {'title': '📌 Hace poco revisé un servicio antiguo y me volvió a pasar lo de siempre: veinte @Value repartidos por la clase para leer el YAML. Funcionaba, sí……', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4D22AQE4K-q3IZocLA/feedshare-shrink_800/B4DZfp5ldjHAAg-/0/1751975877295?e=2147483647&v=beta&t=EkFkwKUIfGYYUm8keZ8L_4qBRH9rXVzFbgUMBNVbcqI', 'link': 'https://es.linkedin.com/posts/pablocuestamorer_java-springboot-configurationproperties-activity-7348319434974842881-pk7H'}, {'title': "📊 𝗘𝘅𝗰𝗲𝗹 𝘃𝘀 𝗦𝗤𝗟 𝘃𝘀 𝗣𝘆𝘁𝗵𝗼𝗻 (𝗣𝗮𝗻𝗱𝗮𝘀): 𝗔 𝗤𝘂𝗶𝗰𝗸 𝗖𝗼𝗺𝗽𝗮𝗿𝗶𝘀𝗼𝗻! If you're working with data, you've likely used…", 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4D22AQHI4XXJN-iz_g/feedshare-shrink_2048_1536/B4DZc1iSO1GUAo-/0/1748949870339?e=2147483647&v=beta&t=460oIm3vPVHE9yaBtj3Fn_Ht6m98bbDuMjKKnJNeaW0', 'link': 'https://www.linkedin.com/posts/python-geeks_python-coding-activity-7335627440456634369-5o9Y'}, {'title': '𝐇𝐨𝐰 𝐈 𝐒𝐭𝐫𝐮𝐜𝐭𝐮𝐫𝐞 𝐌𝐲 𝐂𝐥𝐞𝐚𝐧 𝐀𝐫𝐜𝐡𝐢𝐭𝐞𝐜𝐭𝐮𝐫𝐞 𝐏𝐫𝐨𝐣𝐞𝐜𝐭𝐬 (𝐅𝐨𝐥𝐝𝐞𝐫 𝐛𝐲 𝐅𝐨𝐥𝐝𝐞𝐫) Clean Architecture isn’t…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4D22AQE5ImXNTZTSww/feedshare-shrink_1280/B4DZbCKN13GUAk-/0/1747014180745?e=2147483647&v=beta&t=iHTn0ebTKzGkGE7EOt4nmtL9jNCPwFaWTk-m6uol2q8', 'link': 'https://www.linkedin.com/posts/pedro-cons_cleanarchitecture-dotnet-backendtips-activity-7328388665708007425-CCw2'}, {'title': '🚀 Estamos buscando nuestro próximo Sales Executive para nuestra marca Yoint by Novatec Solutions🔍 Si tienes experiencia en ventas en el sector…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D5622AQFbMt2sROKlvQ/feedshare-shrink_800/B56ZZapW_oHsAg-/0/1745277515571?e=2147483647&v=beta&t=nQVICqbw7XsBG6Aol5sUTA4u-ID5D8ozFQZdPADscgA', 'link': 'https://es.linkedin.com/posts/novatecsolutions_estamos-buscando-nuestro-pr%C3%B3ximo-sales-activity-7320224468822372352-ypY1'}, {'title': '¡Me alegra contaros que he obtenido un nuevo certificado: AWS Certified Cloud Practitioner, view my verified achievement from Amazon Web Services…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E10AQEIeao6WHyT6g/image-shrink_800/B4EZZB2R2zHMAg-/0/1744861470974?e=2147483647&v=beta&t=fV7RLViA4Nm0d1Lm0koFmf56Yvz3gdpdN7T_axvE1LI', 'link': 'https://www.linkedin.com/posts/jeisson-lopez-espinosa_aws-certified-cloud-practitioner-was-issued-activity-7318479448452784128-LIoN'}, {'title': 'Con el apoyo de #Unesco, #Learning by helping fue un espacio de crecimiento para pensar la educación a partir de las realidades en las regiones. Los…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E22AQGjvpzyycwGzw/feedshare-shrink_2048_1536/feedshare-shrink_2048_1536/0/1733857852361?e=2147483647&v=beta&t=HmxhR_0V0RIgUXdSwSmb319Bo-1TSjz2DNJRfwAw3bs', 'link': 'https://es.linkedin.com/posts/yolima-rodr%C3%ADguezez-jim%C3%A9nez-2a69aa34_unesco-learning-activity-7272326929528066048-_r85'}, {'title': 'El dinero no compra la felicidad, pero bien gestionado puede acercarnos a ella. 🌟 Con Wioba, planificar tus finanzas es sencillo: organiza tus…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://dms.licdn.com/playlist/vid/v2/D4E05AQHI1VoyjYnKKg/feedshare-video-thumbnail-high/B4EZRvdkwfHMCY-/0/1737036827018?e=2147483647&v=beta&t=u7Ibc9Fut9PYmrGHaHjRvBVc71uo36M-w2MahxKEitI', 'link': 'https://es.linkedin.com/posts/wioba_wioba-app-planeaci%C3%B3nfinanciera-activity-7285664614996951040-Olzo'}, {'title': 'Así celebramos en Novatec ✨🎉 Nuestra fiesta de fin de año estuvo llena de sonrisas, juegos y momentos inolvidables para los más pequeños. 🧡 📸…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E22AQEiprf1k7MBnQ/feedshare-shrink_2048_1536/B4EZP1zperHEAs-/0/1734995780618?e=2147483647&v=beta&t=yfvPF6VP84xxweWPsCCqDa7LS4xb58RedJaqgYkmuNo', 'link': 'https://es.linkedin.com/posts/novatecsolutions_novatec-novateritos-fiestadefindea%C3%B1o-activity-7277099767879413760-xEBv'}, {'title': 'El #OpenFinance permite democratizar las finanzas ampliando la oferta de servicios que se adapten a las necesidades de los usuarios y aprovechando…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E22AQEIRxjI4z7OFw/feedshare-shrink_800/feedshare-shrink_800/0/1729801948765?e=2147483647&v=beta&t=NG6qkFExX7JV5M-BD4UlEbz4cxdyCreyVHptmN_oUSc', 'link': 'https://es.linkedin.com/posts/yoint_openfinance-openbanking-openfinance-activity-7255315235874435073-a1I3'}, {'title': '💸💡 ¡Es hora de desmentir los mitos sobre el dinero! ¿Sabías que muchas creencias sobre el dinero son solo eso, mitos? 🚫🔍 #FinanzasPersonales…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D5605AQE-p2lHhpp99g/feedshare-thumbnail_720_1280/feedshare-thumbnail_720_1280/0/1729636643367?e=2147483647&v=beta&t=Db2F4ku0ewrQXVZ34Kvdun_tTa-yakTVnAKioS5z4Z4', 'link': 'https://es.linkedin.com/posts/wioba_finanzaspersonales-mitosdeldinero-wioba-activity-7254622014299090945-HbeM'}, {'title': '💚 ¡Tu bienestar financiero es clave para una buena salud mental! Descubre cómo pequeños cambios pueden hacer una gran diferencia. ✨ #saludmental…', 'subtitle': 'Liked by Miguel Angel Garzon Sanabria', 'image_url': 'https://media.licdn.com/dms/image/v2/D4E05AQGW489JxD6XRw/videocover-high/videocover-high/0/1728580619211?e=2147483647&v=beta&t=b-fvbMs6ik7zoFAYFXX__AT9YjkpW68uNjC18Eo2Tnc', 'link': 'https://es.linkedin.com/posts/wioba_saludmental-saludemocional-saludfinanciera-activity-7250192789093675008-xs7h'}], 'similar_profiles': [], 'patents': []}, 'usage': {'credits': 0}}


    Genera dos outputs separados:
    1. HTML: Estructura completa del CV con clases CSS
    2. CSS: Estilos responsive y profesionales

    El CV debe incluir:
    - Información personal
    - Resumen profesional
    - Experiencia laboral
    - Educación
    - Habilidades
    - Diseño responsive y moderno
    `;

    const { text } = await generateText({
      model: google('gemini-2.0-flash'),
      prompt,
    });

    const htmlMatch = text.match(/```html([\s\S]*?)```/);
    const cssMatch = text.match(/```css([\s\S]*?)```/);

    const htmlContent = htmlMatch ? htmlMatch[1].trim() : '';
    const cssContent = cssMatch ? cssMatch[1].trim() : '';

    return {
      htmlContent,
      cssContent,
      rawContent: profileContent || '',
    };
  } catch (error) {
    console.error('Error generating CV:', error);
    throw new Error('Failed to generate CV');
  }
}
